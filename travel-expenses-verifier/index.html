<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>여비 계산·검증 통합 도구 (실무자/감사관)</title>

  <!-- 공통 스타일 -->
  <link rel="stylesheet" href="/static/style.css" />

  <style>
    /* 탭 전환용 버튼 스타일 약간 보정 */
    .mode-tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    .mode-tab {
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid #d4d4d8;
      background: #f9fafb;
      cursor: pointer;
      font-size: 1rem;
    }
    .mode-tab.active {
      background: #111;
      color: #fff;
      border-color: #111;
    }

    .field-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .field-row label {
      min-width: 150px;
      font-size: 1rem;
    }
    .field-row input,
    .field-row select {
      min-width: 0;
      flex: 1 1 180px;
      max-width: 260px;
    }

    .result-box {
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      padding: 12px 14px;
      background: #fafafa;
      margin-top: 10px;
      font-size: 1rem;
    }
    .result-line {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      margin: 2px 0;
    }
    .result-label {
      font-weight: 600;
    }
    .result-value {
      text-align: right;
      min-width: 120px;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 0.85rem;
      background: #f3f4f6;
      color: #374151;
      border: 1px solid #e5e7eb;
    }
  </style>
</head>
<body>
  <!-- 상단 메인으로 돌아가기 -->
  <div class="home-link-wrap">
    <a href="/" class="btn-home">← 메인으로 돌아가기</a>
  </div>

  <!-- 헤더 -->
  <header class="site-header">
    <div class="shell">
      <h1>여비 계산·검증 통합 도구</h1>
      <p class="sub">
        · 실무자용 여비 계산기와 감사관용 여비 검증기를 한 화면에서 전환해 사용할 수 있습니다.<br />
        · 4시간 기준 관내여비(반일 10,000원 / 종일 20,000원) 및 국내 근무지 외 여비규정(일비·식비·숙박비 상한)을 전제로 합니다.
      </p>

      <div class="mode-tabs">
        <button type="button" class="mode-tab active" data-mode="worker">
          실무자용 여비 계산기
        </button>
        <button type="button" class="mode-tab" data-mode="auditor">
          감사관용 여비 검증기
        </button>
      </div>
    </div>
  </header>

  <main>
    <!-- =========================
         A. 실무자용 여비 계산기
         ========================= -->
    <section class="section" id="mode-worker">
      <h2 class="local-h2">A. 실무자용 여비 계산기</h2>
      <p class="local-small muted">
        · 출장 전에 “관내/관외, 반일/종일, 숙박 여부”를 기준으로 예상 여비를 산출하는 용도입니다.<br />
        · 실제 지출결의 시에는 반드시 해당 연도 여비 규정 및 교육청·학교 내부 기준을 함께 확인해야 합니다.
      </p>

      <!-- 1. 계산 유형 -->
      <div class="card">
        <h3 class="local-h3">1. 계산 구분</h3>
        <div class="field-row">
          <label>출장 유형</label>
          <div>
            <label><input type="radio" name="calcType" value="inner" checked> 근무지 내 국내출장 (관내)</label>
            &nbsp;&nbsp;
            <label><input type="radio" name="calcType" value="outer"> 근무지 외 국내출장 (관외)</label>
          </div>
        </div>
        <p class="local-small muted">
          · 관내: 왕복 2km 이상, 4시간 기준 반일(10,000원)·종일(20,000원) 정액을 전제로 합니다.<br />
          · 관외: 일비·식비·숙박비·운임을 모두 합산해서 예상 여비를 계산합니다.
        </p>
      </div>

      <!-- 2. 근무지 내 계산기 -->
      <div class="card" id="section-inner">
        <h3 class="local-h3">2. 근무지 내 국내출장 계산 (관내)</h3>

        <div class="field-row">
          <label for="innerDistance">왕복 거리 (km)</label>
          <input type="number" id="innerDistance" min="0" step="0.1" class="numeric" placeholder="예: 5" />
        </div>

        <div class="field-row">
          <label for="innerHours">출장 소요시간 (시간)</label>
          <input type="number" id="innerHours" min="0" step="0.1" class="numeric" placeholder="예: 3.5" />
        </div>

        <div class="field-row">
          <label>공용차량/임차차량 사용</label>
          <div>
            <label><input type="radio" name="innerCar" value="no" checked> 사용 안 함</label>
            &nbsp;&nbsp;
            <label><input type="radio" name="innerCar" value="yes"> 사용함 (공용차·업무용택시·렌트 등)</label>
          </div>
        </div>

        <div class="field-row">
          <label for="innerActualShort">근거리 실비 (왕복 2km 이내, 선택)</label>
          <input type="number" id="innerActualShort" min="0" step="100" class="numeric"
                 placeholder="왕복 2km 이내일 때 실제 운임+식비 합계" />
        </div>

        <p class="local-small muted">
          · 왕복 2km 초과: 4시간 미만 10,000원 / 4시간 이상 20,000원 (공용차량 사용 시 10,000원 감액).<br />
          · 왕복 2km 이내: 정액 대신 실비 지급(4시간 미만 최대 10,000원, 4시간 이상 최대 20,000원) 전제로 합니다.
        </p>

        <div class="row" style="margin-top:10px;">
          <button type="button" class="btn primary" id="btnInner">관내 여비 계산</button>
        </div>

        <div class="result-box" id="innerResult" style="display:none;"></div>
      </div>

      <!-- 3. 근무지 외 계산기 -->
      <div class="card" id="section-outer" style="display:none;">
        <h3 class="local-h3">3. 근무지 외 국내출장 계산 (관외)</h3>

        <div class="grid two">
          <div class="field">
            <label for="outerDays">출장일수 (일)</label><br />
            <input type="number" id="outerDays" min="1" step="1" class="numeric" placeholder="예: 2" />
          </div>
          <div class="field">
            <label for="outerNights">숙박일수 (박)</label><br />
            <input type="number" id="outerNights" min="0" step="1" class="numeric" placeholder="예: 1" />
          </div>
        </div>

        <div class="grid two" style="margin-top:8px;">
          <div class="field">
            <label for="outerRegion">숙박 지역 구분</label><br />
            <select id="outerRegion">
              <option value="seoul">서울특별시</option>
              <option value="metro">광역시</option>
              <option value="other" selected>기타·세종·제주</option>
            </select>
          </div>
          <div class="field">
            <label for="outerLodgingSpent">실제(예상) 숙박비 합계 (원)</label><br />
            <input type="number" id="outerLodgingSpent" min="0" step="100" class="numeric"
                   placeholder="영수증 또는 예상 숙박비 합계" />
          </div>
        </div>

        <div class="field-row">
          <label>숙박 상한 30% 가산</label>
          <div>
            <label><input type="radio" name="outerLodgingExtra" value="no" checked> 미적용</label>
            &nbsp;&nbsp;
            <label><input type="radio" name="outerLodgingExtra" value="yes"> 적용 (성수기·불가피 사유)</label>
          </div>
        </div>

        <div class="field-row">
          <label for="outerCarDays">공용/임차 차량 사용일수</label>
          <input type="number" id="outerCarDays" min="0" step="1" class="numeric"
                 placeholder="일비 1/2 적용 일수" />
        </div>

        <div class="field-row">
          <label>항공마일리지 사용</label>
          <div>
            <label><input type="radio" name="outerMileage" value="no" checked> 사용 안 함</label>
            &nbsp;&nbsp;
            <label><input type="radio" name="outerMileage" value="yes"> 사용함 (보너스권/좌석승급)</label>
          </div>
        </div>

        <div class="grid two">
          <div class="field">
            <label for="outerMealsProvided">무료 제공 식사 횟수</label><br />
            <input type="number" id="outerMealsProvided" min="0" step="1" class="numeric" placeholder="예: 2" />
          </div>
          <div class="field">
            <label for="outerLongStayRate">장기체재 일비 감액율</label><br />
            <select id="outerLongStayRate">
              <option value="1.0" selected>미적용 (100%)</option>
              <option value="0.9">90%</option>
              <option value="0.8">80%</option>
              <option value="0.7">70%</option>
            </select>
          </div>
        </div>

        <div class="field-row">
          <label for="outerFare">운임 실비 (원)</label>
          <input type="number" id="outerFare" min="0" step="100" class="numeric"
                 placeholder="철도·항공·버스 등 실제 또는 예상 운임 합계" />
        </div>

        <p class="local-small muted">
          · 일비·식비·숙박비는 여비규정 정액·상한 기준으로, 운임은 입력한 실비를 그대로 합산합니다.<br />
          · 항공마일리지 사용 시 일비 50% 추가(절약된 운임의 1/2 한도)는 실제 집행 시 별도 검토가 필요합니다.
        </p>

        <div class="row" style="margin-top:10px;">
          <button type="button" class="btn primary" id="btnOuter">관외 여비 계산</button>
        </div>

        <div class="result-box" id="outerResult" style="display:none;"></div>
      </div>
    </section>

    <!-- =========================
         B. 감사관용 여비 검증기
         ========================= -->
    <section class="section" id="mode-auditor" style="display:none;">
      <h2 class="local-h2">B. 감사관용 여비 검증기</h2>
      <p class="local-small muted">
        · 지출결의서·나이스 원자료 기준으로 “관내 반일/종일 건수”와 “금액”이 맞는지 검증하는 용도입니다.<br />
        · 2025년 5월 문막초 관내여비 지출결의서(총 450,000원)를 참고한 구조입니다.
      </p>

      <!-- 1. 월간 집계 검증 -->
      <div class="card">
        <h3 class="local-h3">1. 월간 관내여비 집계 검증</h3>

        <div class="grid two">
          <div class="field">
            <label for="monthLabel">검증 대상 연월(자유 입력)</label><br />
            <input type="text" id="monthLabel" placeholder="예: 2025년 5월 관내여비" />
          </div>
          <div class="field">
            <label for="decidedTotal">지출결의 총액 (원)</label><br />
            <input type="number" id="decidedTotal" class="numeric" placeholder="예: 450000" />
          </div>
        </div>

        <hr />

        <div class="grid two">
          <div class="field">
            <label for="halfCount">반일(4시간 미만) 출장 건수</label><br />
            <input type="number" id="halfCount" class="numeric" min="0" step="1" placeholder="예: 15" />
          </div>
          <div class="field">
            <label for="fullCount">종일(4시간 이상) 출장 건수</label><br />
            <input type="number" id="fullCount" class="numeric" min="0" step="1" placeholder="예: 8" />
          </div>
        </div>

        <div class="grid two" style="margin-top:8px;">
          <div class="field">
            <label for="unitHalf">반일 단가 (원)</label><br />
            <input type="number" id="unitHalf" class="numeric" value="10000" />
          </div>
          <div class="field">
            <label for="unitFull">종일 단가 (원)</label><br />
            <input type="number" id="unitFull" class="numeric" value="20000" />
          </div>
        </div>

        <div class="row" style="margin-top:12px;">
          <button type="button" class="btn primary" id="btnVerifyMonthly">
            월간 집계 검증
          </button>
          <button type="button" class="btn ghost" id="btnResetMonthly">
            값 초기화
          </button>
        </div>

        <div id="monthlyResult" class="result-box" style="margin-top:12px; display:none;"></div>
      </div>

      <!-- 2. 개별 지급내역 행 단위 검증 -->
      <div class="card">
        <h3 class="local-h3">2. 개별 지급내역 행 단위 검증 (수동 입력)</h3>

        <p class="local-small muted">
          · 나이스 원자료에서 이름 / 관내-반일·종일 여부 / 금회지급액을 보고, 아래 표에 그대로 입력합니다.<br />
          · 각 행에 대해 “규정상 기대액”과 실제 입력액을 비교하여 불일치 여부를 표시합니다.
        </p>

        <div class="grid two" style="margin-top:8px;">
          <div class="field">
            <label for="detailUnitHalf">반일 단가 (원)</label><br />
            <input type="number" id="detailUnitHalf" class="numeric" value="10000" />
          </div>
          <div class="field">
            <label for="detailUnitFull">종일 단가 (원)</label><br />
            <input type="number" id="detailUnitFull" class="numeric" value="20000" />
          </div>
        </div>

        <div class="table-wrap" style="margin-top:10px;">
          <table class="sheetlike simple-table" id="detailTable">
            <thead>
              <tr>
                <th style="width:40px;">No</th>
                <th style="min-width:130px;">성명</th>
                <th style="min-width:160px;">구분</th>
                <th style="min-width:120px;">지급액(원)</th>
                <th style="min-width:130px;">규정상 기대액(원)</th>
                <th style="min-width:150px;">결과</th>
              </tr>
            </thead>
            <tbody>
              <!-- JS로 행 추가 -->
            </tbody>
          </table>
        </div>

        <div class="row gap" style="margin-top:8px;">
          <button type="button" class="btn" id="btnAddRow">행 추가</button>
          <button type="button" class="btn ghost" id="btnClearRows">전체 행 삭제</button>
          <button type="button" class="btn primary" id="btnVerifyDetails">행 단위 검증</button>
        </div>

        <div id="detailSummary" class="result-box" style="margin-top:12px; display:none;"></div>
      </div>

      <div class="card">
        <h3 class="local-h3">3. 감사 시 유의사항</h3>
        <ul class="local-small">
          <li>이 검증기는 관내 왕복 2km 이상 정액 기준만 반영합니다.</li>
          <li>왕복 2km 이내 근거리 실비, 운전원 특례, 1일 2회 이상 출장 상한 등은 별도의 감사 기준에 따라 판단해야 합니다.</li>
          <li>여비명세서, 출장명령서, 나이스 원자료, 지출결의서 사이의 인원·횟수·금액 일치 여부도 함께 확인하는 것이 좋습니다.</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="shell">
      <p>여비 계산·검증 통합 도구 (travel-expenses-verifier)</p>
      <p class="muted">
        · 실무자용 여비 계산기 + 감사관용 여비 검증기 시범 버전입니다. 실제 집행·감사 시에는 최신 여비 규정과 기관 지침을 반드시 병행해 확인해야 합니다.
      </p>
    </div>
  </footer>

  <script src="script.js"></script>
</body>
</html>
